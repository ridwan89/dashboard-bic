<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bus Intelligence Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        /* ... (CSS sebelumnya tetap sama) ... */

        /* Bagian Kapasitas Bagasi - Diperbarui */
        .bagasi-info {
            display: table;
            width: 100%;
            margin-bottom: 8px;
        }
        
        .bagasi-row {
            display: table-row;
        }
        
        .bagasi-label, .bagasi-value {
            display: table-cell;
            padding: 4px 0;
            text-align: left;
            font-size: 13px; /* Ukuran teks disamakan dengan widget lain */
        }
        
        .bagasi-label {
            font-weight: bold;
            width: 50%;
        }
        
        /* ... (CSS lainnya tetap sama) ... */
    </style>
</head>
<body>
    <!-- ... (Bagian HTML sebelumnya tetap sama) ... -->
    
    <!-- Bagasi Widget - Diperbarui -->
    <div class="widget" id="bagasi-widget">
        <div class="widget-header">
            <h3 class="widget-title">Bagasi</h3>
            <i class="fas fa-suitcase widget-icon"></i>
        </div>
        <div class="bagasi-info">
            <div class="bagasi-row">
                <div class="bagasi-label">Kapasitas</div>
                <div class="bagasi-value">75% <span class="widget-status status-warning">Terisi</span></div>
            </div>
            <div class="bagasi-row">
                <div class="bagasi-label">Pintu Bagasi</div>
                <div class="bagasi-value">Tertutup <span class="widget-status status-normal">Aman</span></div>
            </div>
        </div>
        <div class="widget-footer">
            <span class="widget-time">Diperbarui 5 menit lalu</span>
            <button class="widget-button" onclick="toggleBagasi()">Kontrol</button>
        </div>
    </div>

    <!-- ... (Bagian HTML lainnya tetap sama) ... -->

    <script>
        // ... (Fungsi JavaScript sebelumnya tetap sama) ...

        // Fungsi untuk update status bagasi secara berkala
        function updateBagasiStatus() {
            const widget = document.getElementById('bagasi-widget');
            if (widget) {
                const capacityElement = widget.querySelector('.bagasi-info .bagasi-value:first-child');
                const doorElement = widget.querySelector('.bagasi-info .bagasi-value:last-child');
                const timeElement = widget.querySelector('.widget-time');
                
                // Generate random capacity between 0-100%
                const randomCapacity = Math.floor(Math.random() * 101);
                let capacityStatus, capacityStatusClass;
                
                if (randomCapacity < 30) {
                    capacityStatus = 'Kosong';
                    capacityStatusClass = 'status-gray';
                } else if (randomCapacity < 70) {
                    capacityStatus = 'Terisi';
                    capacityStatusClass = 'status-normal';
                } else if (randomCapacity < 90) {
                    capacityStatus = 'Hampir Penuh';
                    capacityStatusClass = 'status-warning';
                } else {
                    capacityStatus = 'Penuh';
                    capacityStatusClass = 'status-danger';
                }
                
                // Generate random door status (90% closed, 10% open)
                const isDoorOpen = Math.random() < 0.1;
                const doorStatus = isDoorOpen ? 'Terbuka' : 'Tertutup';
                const doorStatusClass = isDoorOpen ? 'status-warning' : 'status-normal';
                const doorStatusText = isDoorOpen ? 'Terbuka!' : 'Aman';
                
                // Update elements
                capacityElement.innerHTML = `${randomCapacity}% <span class="widget-status ${capacityStatusClass}">${capacityStatus}</span>`;
                doorElement.innerHTML = `${doorStatus} <span class="widget-status ${doorStatusClass}">${doorStatusText}</span>`;
                timeElement.innerText = 'Diperbarui baru saja';
            }
        }

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', function() {
            // ... (Inisialisasi sebelumnya tetap sama) ...
            
            // Set interval untuk update bagasi setiap 15 detik
            setInterval(updateBagasiStatus, 15000);
            
            // Jalankan sekali saat pertama kali load
            updateBagasiStatus();
            
            // ... (Inisialisasi lainnya tetap sama) ...
        });
    </script>
</body>
</html>
